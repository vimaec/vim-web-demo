{"version":3,"file":"index.js","sources":["../../vite/modulepreload-polyfill","../../src/assets/logo.png","../../src/vimReact.tsx","../../src/vimWebApp.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","export default \"__VITE_ASSET__93547066__\"","// eslint-disable-next-line no-use-before-define\r\nimport React, { useState } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport urlLogo from './assets/logo.png'\r\nimport './style.css'\r\n\r\nconst canvasId = 'vim-canvas'\r\n\r\n\r\ntype Progress = 'processing'| number | string\r\nexport function buildUI():[string, (state : Progress) => void]{\r\n  // Create container for React\r\n  const ui = document.createElement('div')\r\n  ui.className = 'vim'\r\n  ui.style.height = '100%'\r\n  document.body.append(ui)\r\n\r\n  // Render\r\n  const obj = {state: '', set: null as (p: Progress) => void }\r\n  ReactDOM.render(<VimUI p={obj} />, ui)\r\n  return [canvasId, (str) => obj.set(str)]\r\n}\r\n\r\nfunction VimUI (props: {p:any }) {\r\n  const [progress, setProgress] = useState<Progress>()\r\n  props.p.msg = progress\r\n  props.p.set = setProgress\r\n\r\n  return (\r\n    <>\r\n      <canvas id={canvasId}> </canvas>\r\n      <Logo />\r\n      <VimLoadingBox progress={progress} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Logo () {\r\n  return (\r\n    <div className=\"vim-logo\">\r\n      <a href=\"https://vimaec.com\">\r\n        <img src={urlLogo}></img>\r\n      </a>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction VimLoadingBox (prop: { progress: Progress }) {\r\n  const msg = \r\n  prop.progress ==='processing' ? 'Processing'\r\n  : typeof(prop.progress) === 'number' ? `Downloading: ${Math.round(prop.progress / 1000000)} MB`\r\n  : typeof(prop.progress) === 'string' ? `Error: ${prop.progress}`\r\n  : undefined\r\n\r\n  if (!msg) return null\r\n  return (\r\n    <div className=\"vim-loading-box\">\r\n      <h1> {msg} </h1>\r\n    </div>\r\n  )\r\n}\r\n","//import { settingsGui } from './settingsGui'\r\nimport { buildUI } from './vimReact'\r\nimport * as VIM from 'vim-webgl-viewer/'\r\nimport Stats from 'stats-js'\r\n\r\n\r\n\r\n// Parse URL\r\nconst params = new URLSearchParams(window.location.search)\r\nlet url = params.has('vim')\r\n  ? params.get('vim')\r\n  : 'https://vim.azureedge.net/samples/residence.vim'\r\n\r\nurl = params.has('model')\r\n? params.get('model')\r\n: 'https://vim.azureedge.net/samples/residence.vim'\r\n\r\n\r\nlet transparency = 'all' as VIM.Transparency.Mode\r\nif (params.has('transparency')) {\r\n  const t = params.get('transparency')\r\n  transparency = VIM.Transparency.IsValid(t) ? t : 'all'\r\n}\r\n\r\n// Create Viewer\r\nconst [canvasId, setProgress] = buildUI()\r\n\r\nconst viewer = new VIM.Viewer({\r\n  canvas: {id : canvasId},\r\n  groundPlane: {\r\n    show: true,\r\n    texture:\r\n      'https://vimdevelopment01storage.blob.core.windows.net/textures/vim-floor-soft.png',\r\n    opacity: 1,\r\n    size: 5\r\n  }\r\n})\r\nviewer.camera\r\n\r\n// Load Model\r\nviewer.loadVim(\r\n  url,\r\n  {\r\n    transparency: transparency,\r\n    rotation: { x: 270, y: 0, z: 0 }\r\n  },\r\n  (result) => setProgress(undefined),\r\n  (progress) => \r\n    setProgress(progress === 'processing' ? 'processing' : progress.loaded)\r\n  ,\r\n  (error) => \r\n    setProgress(error.message)\r\n  )\r\n\r\n// Make viewer accessible in console\r\nglobalThis.viewer = viewer\r\n\r\n/*\r\n// Add a new DAT.gui controller\r\nsettingsGui.bind(viewer.settings, (settings) => {\r\n  viewer.settings = settings\r\n  viewer.ApplySettings()\r\n})\r\n*/\r\n\r\n// Add Stats display\r\nconst stats = new Stats()\r\nstats.dom.style.top = '84px'\r\nstats.dom.style.left = '16px'\r\ndocument.body.appendChild(stats.dom)\r\nanimate()\r\n\r\nfunction animate () {\r\n  requestAnimationFrame(() => animate())\r\n\r\n  if (stats) {\r\n    stats.update()\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"names":["canvasId","useState","VIM.Transparency","VIM.Viewer"],"mappings":"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"}