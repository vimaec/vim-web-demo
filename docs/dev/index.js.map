{"version":3,"file":"index.js","sources":["../../vite/modulepreload-polyfill","../../src/assets/logo.png","../../src/vimReact.tsx","../../src/vimWebApp.ts"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","export default \"__VITE_ASSET__93547066__\"","// eslint-disable-next-line no-use-before-define\r\nimport React, { useState } from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport {ViewerState} from 'vim-webgl-viewer'\r\nimport urlLogo from './assets/logo.png'\r\nimport './style.css'\r\n\r\nconst canvasId = 'vim-canvas'\r\n\r\nexport function buildUI (viewerEventName: string): string {\r\n  // Create container for React\r\n  const ui = document.createElement('div')\r\n  ui.className = 'vim'\r\n  ui.style.height = '100%'\r\n  document.body.append(ui)\r\n\r\n  // Render\r\n  ReactDOM.render(<VimUI eventName={viewerEventName} />, ui)\r\n  return canvasId\r\n}\r\n\r\nfunction VimUI (props: { eventName: string }) {\r\n  const [msg, setProgress] = useState('')\r\n\r\n  addEventListener(props.eventName, (event: CustomEvent<ViewerState>) => {\r\n    setProgress(FormatStateMessage(event.detail))\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <canvas id={canvasId}> </canvas>\r\n      <Logo />\r\n      <VimLoadingBox msg={msg} />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction Logo () {\r\n  return (\r\n    <div className=\"vim-logo\">\r\n      <a href=\"https://vimaec.com\">\r\n        <img src={urlLogo}></img>\r\n      </a>\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction FormatStateMessage (state: ViewerState): string {\r\n\r\n  if (state[0] === 'Downloading') {\r\n    return `Downloading: ${Math.round((state[1] as number) / 1000000)} MB`\r\n  }\r\n  if (state[0] === 'Error') {\r\n    return 'Error : ' + (state[1] as ErrorEvent).message\r\n  }\r\n  if (state === 'Processing') return 'Processing'\r\n}\r\n\r\nfunction VimLoadingBox (prop: { msg: string }) {\r\n  if (!prop.msg) return null\r\n  return (\r\n    <div className=\"vim-loading-box\">\r\n      <h1> {prop.msg} </h1>\r\n    </div>\r\n  )\r\n}\r\n","//import { settingsGui } from './settingsGui'\r\nimport { buildUI } from './vimReact'\r\nimport {Viewer} from 'vim-webgl-viewer'\r\nimport Stats from 'stats-js'\r\n\r\n// Parse URL\r\nconst params = new URLSearchParams(window.location.search)\r\nconst url = params.has('model')\r\n  ? params.get('model')\r\n  : 'https://vim.azureedge.net/samples/residence.vim'\r\n\r\n  let drawTransparency = true\r\n  let transparencyAsOpaque = false\r\n  if (params.has('transparency')) {\r\n    const t = params.get('transparency')\r\n    drawTransparency = t !== 'false'\r\n    transparencyAsOpaque = t === 'opaque'\r\n  }\r\n\r\n// Create Viewer\r\nconst canvasId = buildUI(Viewer.stateChangeEvent)\r\n\r\nconst viewer = new Viewer({\r\n  canvas: {id : canvasId},\r\n  plane: {\r\n    show: true,\r\n    texture:\r\n      'https://vimdevelopment01storage.blob.core.windows.net/textures/vim-floor-soft.png',\r\n    opacity: 1,\r\n    size: 5\r\n  }\r\n})\r\n// Load Model\r\nviewer.loadModel(\r\n  {\r\n    drawTransparency: drawTransparency,\r\n    drawTransparencyAsOpaque: transparencyAsOpaque,\r\n    url: url,\r\n    rotation: { x: 270, y: 0, z: 0 }\r\n  },\r\n  (vim) => console.log('Callback: Viewer Ready!'),\r\n  (progress) => {\r\n    if (progress === 'processing') console.log('Callback: Processing')\r\n    else {\r\n      console.log(`Callback: Downloading: ${progress.loaded / 1000000} MB`)\r\n    }\r\n  },\r\n  (error) => console.error('Callback: Error: ' + error.message)\r\n)\r\n\r\n// Make viewer accessible in console\r\nglobalThis.viewer = viewer\r\n\r\n/*\r\n// Add a new DAT.gui controller\r\nsettingsGui.bind(viewer.settings, (settings) => {\r\n  viewer.settings = settings\r\n  viewer.ApplySettings()\r\n})\r\n*/\r\n\r\n// Add Stats display\r\nconst stats = new Stats()\r\nstats.dom.style.top = '84px'\r\nstats.dom.style.left = '16px'\r\ndocument.body.appendChild(stats.dom)\r\nanimate()\r\n\r\nfunction animate () {\r\n  requestAnimationFrame(() => animate())\r\n\r\n  if (stats) {\r\n    stats.update()\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"names":["canvasId","useState"],"mappings":";AAAA,MAAM,IAAI,oBAAoB;AAC1B,QAAM,UAAU,SAAS,cAAc,QAAQ;AAC/C,MAAI,WAAW,QAAQ,YAAY,QAAQ,SAAS,kBAAkB;AAClE;AAAA;AAEJ,aAAW,QAAQ,SAAS,iBAAiB,8BAA8B;AACvE,mBAAe;AAAA;AAEnB,MAAI,iBAAiB,CAAC,cAAc;AAChC,eAAW,YAAY,WAAW;AAC9B,UAAI,SAAS,SAAS,aAAa;AAC/B;AAAA;AAEJ,iBAAW,QAAQ,SAAS,YAAY;AACpC,YAAI,KAAK,YAAY,UAAU,KAAK,QAAQ;AACxC,yBAAe;AAAA;AAAA;AAAA,KAG5B,QAAQ,UAAU,EAAE,WAAW,MAAM,SAAS;AACjD,wBAAsB,QAAQ;AAC1B,UAAM,YAAY;AAClB,QAAI,OAAO;AACP,gBAAU,YAAY,OAAO;AACjC,QAAI,OAAO;AACP,gBAAU,iBAAiB,OAAO;AACtC,QAAI,OAAO,gBAAgB;AACvB,gBAAU,cAAc;AAAA,aACnB,OAAO,gBAAgB;AAC5B,gBAAU,cAAc;AAAA;AAExB,gBAAU,cAAc;AAC5B,WAAO;AAAA;AAEX,0BAAwB,MAAM;AAC1B,QAAI,KAAK;AAEL;AACJ,SAAK,KAAK;AAEV,UAAM,YAAY,aAAa;AAC/B,UAAM,KAAK,MAAM;AAAA;AAAA;AAEvB,AAAoB;;AC1CtB,cAAe;ACOf,MAAMA,aAAW;iBAEQ,iBAAiC;QAElD,KAAK,SAAS,cAAc;KAC/B,YAAY;KACZ,MAAM,SAAS;WACT,KAAK,OAAO;WAGZ,2CAAQ,OAAD;AAAA,IAAO,WAAW;AAAA,MAAqB;SAChDA;AAAAA;AAGT,eAAgB,OAA8B;QACtC,CAAC,KAAK,eAAeC,uBAAS;mBAEnB,MAAM,WAAW,CAAC,UAAoC;gBACzD,mBAAmB,MAAM;AAAA;uGAKlC,UAAD;AAAA,IAAQ,IAAID;AAAAA,KAAU,0CACrB,MAAD,2CACC,eAAD;AAAA,IAAe;AAAA;AAAA;AAKrB,gBAAiB;6CAEZ,OAAD;AAAA,IAAK,WAAU;AAAA,yCACZ,KAAD;AAAA,IAAG,MAAK;AAAA,yCACL,OAAD;AAAA,IAAK,KAAK;AAAA;AAAA;AAMlB,4BAA6B,OAA4B;MAEnD,MAAM,OAAO,eAAe;WACvB,gBAAgB,KAAK,MAAO,MAAM,KAAgB;AAAA;MAEvD,MAAM,OAAO,SAAS;WACjB,aAAc,MAAM,GAAkB;AAAA;MAE3C,UAAU;WAAqB;AAAA;AAGrC,uBAAwB,MAAuB;MACzC,CAAC,KAAK;WAAY;6CAEnB,OAAD;AAAA,IAAK,WAAU;AAAA,yCACZ,MAAD,MAAI,KAAE,KAAK,KAAI;AAAA;ACxDrB,MAAM,SAAS,IAAI,gBAAgB,OAAO,SAAS;AACnD,MAAM,MAAM,OAAO,IAAI,WACnB,OAAO,IAAI,WACX;AAEF,IAAI,mBAAmB;AACvB,IAAI,uBAAuB;AAC3B,IAAI,OAAO,IAAI,iBAAiB;QACxB,IAAI,OAAO,IAAI;qBACF,MAAM;yBACF,MAAM;AAAA;AAIjC,MAAM,WAAW,QAAQ,OAAO;AAEhC,MAAM,SAAS,IAAI,OAAO;AAAA,EACxB,QAAQ,EAAC,IAAK;AAAA,EACd,OAAO;AAAA,IACL,MAAM;AAAA,IACN,SACE;AAAA,IACF,SAAS;AAAA,IACT,MAAM;AAAA;AAAA;AAIV,OAAO,UACL;AAAA,EACE;AAAA,EACA,0BAA0B;AAAA,EAC1B;AAAA,EACA,UAAU,EAAE,GAAG,KAAK,GAAG,GAAG,GAAG;AAAA,GAE/B,CAAC,QAAQ,QAAQ,IAAI,4BACrB,CAAC,aAAa;MACR,aAAa;YAAsB,IAAI;AAAA,OACtC;YACK,IAAI,0BAA0B,SAAS,SAAS;AAAA;AAAA,GAG5D,CAAC,UAAU,QAAQ,MAAM,sBAAsB,MAAM;AAIvD,WAAW,SAAS;AAWpB,MAAM,QAAQ,IAAI;AAClB,MAAM,IAAI,MAAM,MAAM;AACtB,MAAM,IAAI,MAAM,OAAO;AACvB,SAAS,KAAK,YAAY,MAAM;AAChC;AAEA,mBAAoB;wBACI,MAAM;MAExB,OAAO;UACH;AAAA;AAAA;"}